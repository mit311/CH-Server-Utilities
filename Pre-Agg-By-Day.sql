select
toDate(hour),
advertiser_id,
campaign_group_id,
campaign_id,
channel_id,
objective_id,
group_id,
creative_id,
sum(display_impressions),
sum(ctv_impressions),
sum(media_cost),
sum(fee_cost),
sum(partner_cost),
sum(data_cost),
sum(media_spend),
sum(data_spend),
sum(platform_spend),
sum(legacy_spend),
sum(ctv_spend),
sum(views),
sum(clicks),
sum(view_conversions),
sum(click_conversions),
sum(view_order_value),
sum(click_order_value),
sum(view_impression),
sum(view_viewed),
sum(view_untrackable),
sum(vast_start),
sum(vast_firstquartile),
sum(vast_midpoint),
sum(vast_thirdquartile),
sum(vast_complete),
uniqArrayState(uniques_arr),
sum(unlinked_spend),
sum(bids),
sum(new_visitors),
uniqArrayState(raw_existing_site_visitors_arr),
uniqArrayState(raw_new_site_visitors_arr),
uniqArrayState(existing_users_reached_arr),
uniqArrayState(new_users_reached_arr),
uniqArrayState(existing_site_visitors_arr),
uniqArrayState(new_site_visitors_arr),
uniqArrayState(site_visitors_arr),
sum(new_to_file),
sum(raw_visits),
sum(raw_conversions),
uniqArrayState(visitors_arr),
sum(raw_order_value),
sum(first_touch_visits),
sum(last_tv_touch_clicks),
sum(last_tv_touch_views),
sum(last_tv_touch_click_conversions),
sum(last_tv_touch_view_conversions),
sum(last_tv_touch_click_order_value),
sum(last_tv_touch_view_order_value),
sum(last_touch_clicks),
sum(last_touch_views),
sum(last_touch_click_conversions),
sum(last_touch_click_order_value),
sum(last_touch_view_order_value),
sum(visits_assist),
sum(conversions_assist_click),
sum(conversions_assist_view),
sum(conversions_assist_click_order_value),
sum(conversions_assist_view_order_value),
sum(last_touch_view_conversions)
from summarydata.all_facts
where hour >= '2024-02-04'
  and hour < '2024-02-05'
group by toDate(hour), advertiser_id, campaign_group_id, campaign_id, channel_id, objective_id, group_id, creative_id;
